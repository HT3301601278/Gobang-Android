# 好友系统

## RESTful API 接口

### 1. 获取好友列表

- **请求方式**: GET
- **接口地址**: `/friends/`
- **请求头**:
  ```
  Authorization: Bearer {token}
  ```
- **响应**:
  ```json
  {
    "success": true,
    "friends": [
      {
        "userId": "用户ID",
        "nickname": "用户昵称",
        "avatar": "头像URL",
        "status": "accepted",
        "addedAt": "添加时间"
      }
    ]
  }
  ```

### 2. 获取好友请求列表

- **请求方式**: GET
- **接口地址**: `/friends/requests`
- **请求头**:
  ```
  Authorization: Bearer {token}
  ```
- **响应**:
  ```json
  {
    "success": true,
    "requests": [
      {
        "fromUserId": "发送者ID",
        "fromNickname": "发送者昵称",
        "fromAvatar": "发送者头像URL",
        "requestedAt": "请求时间"
      }
    ]
  }
  ```

### 3. 发送好友请求

- **请求方式**: POST
- **接口地址**: `/friends/add`
- **请求头**:
  ```
  Authorization: Bearer {token}
  Content-Type: application/json
  ```
- **请求体**:
  ```json
  {
    "friendUserId": "目标用户ID"
  }
  ```
- **响应**:
  ```json
  {
    "success": true,
    "message": "好友请求已发送"
  }
  ```

### 4. 接受好友请求

- **请求方式**: PUT
- **接口地址**: `/friends/accept/{fromUserId}`
- **请求头**:
  ```
  Authorization: Bearer {token}
  ```
- **响应**:
  ```json
  {
    "success": true,
    "message": "好友请求已接受",
    "friend": {
      "userId": "好友ID",
      "nickname": "好友昵称",
      "avatar": "好友头像URL"
    }
  }
  ```

### 5. 拒绝好友请求

- **请求方式**: DELETE
- **接口地址**: `/friends/reject/{fromUserId}`
- **请求头**:
  ```
  Authorization: Bearer {token}
  ```
- **响应**:
  ```json
  {
    "success": true,
    "message": "好友请求已拒绝"
  }
  ```

### 6. 删除好友

- **请求方式**: DELETE
- **接口地址**: `/friends/{friendId}`
- **请求头**:
  ```
  Authorization: Bearer {token}
  ```
- **响应**:
  ```json
  {
    "success": true,
    "message": "好友已删除"
  }
  ```

### 7. 搜索用户（添加好友用）

- **请求方式**: GET
- **接口地址**: `/friends/search`
- **请求头**:
  ```
  Authorization: Bearer {token}
  ```
- **请求参数**:

| 参数名  | 类型   | 必填 | 说明                    |
| ------- | ------ | ---- | ----------------------- |
| keyword | string | 是   | 搜索关键词，至少2个字符 |

- **响应**:
  ```json
  {
    "success": true,
    "users": [
      {
        "userId": "用户ID",
        "nickname": "用户昵称",
  		"avatar": {
  			"type": "头像类型(default/custom/system)",
  			"url": "头像URL"
  		}
      }
    ]
  }
  ```

## Socket.io 事件

### 客户端接收事件

#### 1. 收到好友请求
- **事件名称**: `friend:request_received`
- **数据格式**:
  ```json
  {
    "fromUserId": "发送者ID",
    "fromNickname": "发送者昵称",
    "fromAvatar": "发送者头像URL",
    "requestedAt": "请求时间"
  }
  ```

#### 2. 好友请求被接受
- **事件名称**: `friend:request_accepted`
- **数据格式**:
  ```json
  {
    "userId": "接受请求的用户ID",
    "nickname": "接受请求的用户昵称",
    "avatar": "接受请求的用户头像URL",
    "message": "你的好友请求已被接受"
  }
  ```

#### 3. 好友状态变化
- **事件名称**: `friend:status_changed`
- **数据格式**:
  ```json
  {
    "userId": "好友用户ID",
    "status": {
      "online": true/false
    }
  }
  ```
