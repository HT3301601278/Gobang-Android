# 五子棋Flutter应用设计大纲

## 项目目录结构

```
gobang/
├── assets/
│   ├── images/
│   │   ├── logo.png
│   │   ├── avatars/ # 系统头像
│   │   ├── emojis/ # 表情包
│   │   └── backgrounds/ # 背景图片
│   └── sounds/ # 游戏音效
├── lib/
│   ├── main.dart # 应用入口
│   ├── app.dart # 应用配置和路由
│   ├── config/
│   │   ├── app_config.dart # 应用配置
│   │   ├── api_endpoints.dart # API端点
│   │   └── socket_events.dart # Socket事件常量
│   ├── models/ # 数据模型
│   │   ├── user.dart # 用户模型
│   │   ├── friend.dart # 好友模型
│   │   ├── room.dart # 房间模型
│   │   ├── game.dart # 游戏模型
│   │   ├── message.dart # 聊天消息模型
│   │   └── game_settings.dart # 游戏设置模型
│   ├── services/ # 服务
│   │   ├── api/ # API服务
│   │   │   ├── api_client.dart # 基础HTTP客户端
│   │   │   ├── auth_service.dart # 认证服务
│   │   │   ├── user_service.dart # 用户服务
│   │   │   ├── friend_service.dart # 好友服务
│   │   │   └── game_service.dart # 游戏服务
│   │   ├── socket/ # Socket服务
│   │   │   ├── socket_client.dart # Socket.IO客户端
│   │   │   ├── room_socket.dart # 房间Socket事件处理
│   │   │   ├── game_socket.dart # 游戏Socket事件处理
│   │   │   ├── friend_socket.dart # 好友Socket事件处理
│   │   │   └── voice_socket.dart # 语音Socket事件处理
│   │   ├── voice/ # 语音服务
│   │   │   ├── voice_service.dart # 语音服务实现
│   │   │   └── audio_processor.dart # 音频处理
│   │   ├── storage_service.dart # 本地存储服务
│   │   └── notification_service.dart # 通知服务
│   ├── providers/ # 状态管理
│   │   ├── auth_provider.dart # 认证状态
│   │   ├── user_provider.dart # 用户信息状态
│   │   ├── friend_provider.dart # 好友状态
│   │   ├── room_provider.dart # 房间状态
│   │   ├── game_provider.dart # 游戏状态
│   │   └── voice_provider.dart # 语音状态
│   ├── screens/ # 页面
│   │   ├── splash_screen.dart # 启动页
│   │   ├── auth/ # 认证相关页面
│   │   │   ├── login_screen.dart # 登录页
│   │   │   ├── register_screen.dart # 注册页
│   │   │   └── forgot_password_screen.dart # 忘记密码页
│   │   ├── home/ # 主页
│   │   │   ├── home_screen.dart # 主页
│   │   │   ├── profile_tab.dart # 个人资料页
│   │   │   ├── friends_tab.dart # 好友列表页
│   │   │   └── rooms_tab.dart # 房间列表页
│   │   ├── profile/ # 个人资料相关
│   │   │   ├── edit_profile_screen.dart # 编辑资料
│   │   │   ├── avatar_selection_screen.dart # 头像选择
│   │   │   ├── stats_screen.dart # 战绩统计
│   │   │   └── settings_screen.dart # 设置页面
│   │   ├── friend/ # 好友相关
│   │   │   ├── friend_detail_screen.dart # 好友详情
│   │   │   ├── friend_requests_screen.dart # 好友请求
│   │   │   └── search_users_screen.dart # 搜索用户
│   │   ├── room/ # 房间相关
│   │   │   ├── create_room_screen.dart # 创建房间
│   │   │   ├── room_detail_screen.dart # 房间详情
│   │   │   └── invite_friends_screen.dart # 邀请好友
│   │   ├── game/ # 游戏相关
│   │   │   ├── game_screen.dart # 游戏页面
│   │   │   ├── game_result_screen.dart # 游戏结果
│   │   │   └── game_history_screen.dart # 历史记录
│   │   └── chat/ # 聊天相关
│   │       └── chat_screen.dart # 聊天页面
│   ├── widgets/ # 组件
│   │   ├── common/ # 通用组件
│   │   │   ├── app_bar.dart # 自定义应用栏
│   │   │   ├── loading_indicator.dart # 加载指示器
│   │   │   ├── avatar_widget.dart # 头像组件
│   │   │   ├── error_dialog.dart # 错误对话框
│   │   │   └── confirmation_dialog.dart # 确认对话框
│   │   ├── auth/ # 认证相关组件
│   │   │   ├── login_form.dart # 登录表单
│   │   │   └── register_form.dart # 注册表单
│   │   ├── friend/ # 好友相关组件
│   │   │   ├── friend_list_item.dart # 好友列表项
│   │   │   └── friend_request_item.dart # 好友请求项
│   │   ├── room/ # 房间相关组件
│   │   │   ├── room_list_item.dart # 房间列表项
│   │   │   └── room_settings_form.dart # 房间设置表单
│   │   ├── game/ # 游戏相关组件
│   │   │   ├── board_widget.dart # 棋盘组件
│   │   │   ├── piece_widget.dart # 棋子组件
│   │   │   ├── game_control_panel.dart # 游戏控制面板
│   │   │   ├── timer_widget.dart # 计时器组件
│   │   │   └── move_history_widget.dart # 走棋历史组件
│   │   ├── chat/ # 聊天相关组件
│   │   │   ├── message_list.dart # 消息列表
│   │   │   ├── message_input.dart # 消息输入框
│   │   │   └── emoji_panel.dart # 表情面板
│   │   └── voice/ # 语音相关组件
│   │       ├── voice_control_panel.dart # 语音控制面板
│   │       └── participant_list.dart # 参与者列表
│   ├── utils/ # 工具类
│   │   ├── validators.dart # 表单验证
│   │   ├── date_formatter.dart # 日期格式化
│   │   ├── token_manager.dart # Token管理
│   │   ├── game_logic.dart # 游戏逻辑工具
│   │   └── audio_utils.dart # 音频处理工具
│   ├── theme/ # 主题
│   │   ├── app_theme.dart # 应用主题
│   │   ├── app_colors.dart # 颜色定义
│   │   └── text_styles.dart # 文字样式
│   └── game/ # 游戏核心逻辑
│       ├── board.dart # 棋盘逻辑
│       ├── move.dart # 走棋逻辑
│       ├── game_controller.dart # 游戏控制器
│       └── win_checker.dart # 胜负判断
└── pubspec.yaml # 项目依赖
```

## 核心功能模块说明

### 1. 用户认证模块
- 实现登录、注册、找回密码功能
- JWT令牌管理和本地存储
- 自动登录和令牌刷新
- 用户资料管理和头像设置

### 2. 好友系统模块
- 好友列表展示
- 好友请求管理
- 好友搜索功能
- 好友状态实时更新

### 3. 房间管理模块
- 创建和加入房间
- 房间设置管理
- 好友邀请功能
- 房主权限控制
- 断线重连处理

### 4. 游戏对战模块
- 标准五子棋规则实现
- 落子、悔棋、和棋、认输功能
- 游戏计时器
- 实时同步棋盘状态
- 游戏结果展示
- 历史对局记录和复盘

### 5. 聊天模块
- 游戏内文字聊天
- 表情和快捷短语
- 聊天历史记录

### 6. 语音聊天模块
- 语音聊天功能
- 麦克风控制
- 参与者管理
- 语音设置选项

### 7. 数据同步与通信
- Socket.IO集成
- 实时事件处理
- 断线重连机制
- 消息队列和失败重试

## 状态管理设计

采用Provider模式管理状态，主要包括：
- AuthProvider: 管理用户认证状态
- UserProvider: 管理用户信息和个人资料
- FriendProvider: 管理好友列表和请求
- RoomProvider: 管理房间信息
- GameProvider: 管理游戏状态
- VoiceProvider: 管理语音聊天状态